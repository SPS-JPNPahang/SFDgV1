<!DOCTYPE html>
<script type="module">
        // ... (Import Firebase sama) ...
        const firebaseConfig = { /* ... firebaseConfig anda ... */ };
        // ... (Inisialisasi Firebase sama) ...

        if (app && auth) {
            document.addEventListener("DOMContentLoaded", () => {
                const GAS_API_URL = "https://script.google.com/macros/s/AKfycbzHnG30XyNX-HOC_1iJn5TarLpUgrcX46mhGrJSXiy6xZwuBIQjbzO66bWkFaqGkULHWg/exec"; // URL API ANDA
                // ... (Pembolehubah lain sama) ...

                onAuthStateChanged(auth, async (user) => { /* ... Logik sama seperti Fasa Ujian CORS Tanpa Auth ... */ });

                // --- apiCall DIUBAHSUAI (JSON, TANPA Authorization) ---
                async function apiCall(action, payload = {}) {
                    showLoading(true);
                    // Tiada logik token di sini
                    try {
                        const requestBody = { action: action, ...payload };
                        const headers = {
                            // --- KEMBALI GUNA application/json ---
                            "Content-Type": "application/json"
                        };
                        // --- Authorization DIKOMENKAN ---
                        // if (idToken) { headers["Authorization"] = `Bearer ${idToken}`; }

                        const response = await fetch(GAS_API_URL, {
                            method: "POST",
                            body: JSON.stringify(requestBody),
                            headers: headers, // Hanya Content-Type
                            mode: 'cors',
                            redirect: "follow"
                        });
                        // ... (Kod pengendalian response sama seperti Fasa Ujian CORS Tanpa Auth) ...
                    } catch (error) {
                        // ... (Kod pengendalian ralat sama seperti Fasa Ujian CORS Tanpa Auth) ...
                    }
                }

                // --- Fungsi log masuk DIUBAHSUAI (Tiada perubahan, hanya panggil Firebase) ---
                document.getElementById("login-form").addEventListener("submit", async (e) => {
                     /* ... Kod sama seperti Fasa Ujian CORS Tanpa Auth ... */
                });

                // ... (Salin semua kod fungsi lain yang tidak berubah) ...
                 // Mulakan aplikasi
            });
        }
    </script>
</body>
</html>
